{"remainingRequest":"/Users/xutingting06/pat/personal-space/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xutingting06/pat/personal-space/src/components/dialogWin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xutingting06/pat/personal-space/src/components/dialogWin.vue","mtime":1589715947083},{"path":"/Users/xutingting06/pat/personal-space/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0ewogIG5hbWU6IiIsCiAgZGF0YSgpewogICAgcmV0dXJuewogICAgICBjb21tZW50czpbXQogICAgfQogIH0sCiAgcHJvcHM6ewogICAgZGlhbG9nV2luVmlzaWJsZTogewogICAgICB0eXBlOiBCb29sZWFuCiAgICB9LAogICAgUm9vdElEOnsKICAgICAgdHlwZTpTdHJpbmcKICAgIH0KICB9LAogIC8vIG1vdW50ZWQoKXsvL+a4suafk+aXtuWKoOi9veivhOiuugogIC8vICAgdGhpcy5sb2FkQ29tbWVudHMoKQogIC8vIH0sCiAgbWV0aG9kczp7CiAgICAvL+Wvueivneeql+WPo+eahOWFs+mXrQogICAgZGlhbG9nV2luQ2xvc2U6ZnVuY3Rpb24oKXsKICAgICAgdGhpcy4kZW1pdCgnY2xvc2VEaWFsb2dXaW4nKQogICAgfSwKICAgIC8v5Yqg6L295Lya6K+d5YaF5a65CiAgICBsb2FkQ29tbWVudHM6ZnVuY3Rpb24oKXsKICAgICAgdGhpcy4kaHR0cC5nZXQoJy9zZXJ2ZXIvY29tbWVudHMvcmVwbGF5P3I9Jyt0aGlzLlJvb3RJRCkudGhlbigKICAgICAgICBmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIC8vIOWkhOeQhuaIkOWKn+eahOe7k+aenAogICAgICAgICAgICBpZiAocmVzLmRhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuY29tbWVudHM9cmVzLmRhdGEuY29tbWVudHM7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgYWxlcnQoIuWxleW8gOivhOiuuuWksei0pe+8jCIrcmVzLmRhdGEuZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIC8vIOWkhOeQhuWksei0peeahOe7k+aenAogICAgICAgICAgYWxlcnQocmVzLmRhdGEpOwogICAgICAgIH0pOwogICAgfSwKICAgIC8v6LipCiAgICBkaXNsaWtlQ29tbWVudDpmdW5jdGlvbihjb21tZW50SW5kZXgsaWQpewogICAgICBpZih0aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0udW5saWtlU2VsZWN0ZWQpewogICAgICAgIHRoaXMuY29tbWVudHNbY29tbWVudEluZGV4XS51bmxpa2VTZWxlY3RlZD1mYWxzZTsKICAgICAgfWVsc2V7CiAgICAgICAgaWYgKHRoaXMuY29tbWVudHNbY29tbWVudEluZGV4XS5saWtlU2VsZWN0ZWQpIHsKICAgICAgICAgIHRoaXMubGlrZUNvbW1lbnQoY29tbWVudEluZGV4LGlkLCdyb3V0ZScpOwogICAgICAgIH0KICAgICAgICB0aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0udW5saWtlU2VsZWN0ZWQ9dHJ1ZTsKICAgICAgfQogICAgfSwKICAgIC8v6LWeCiAgICBsaWtlQ29tbWVudDpmdW5jdGlvbihjb21tZW50SW5kZXgsaWQscm91dGUpewogICAgICBsZXQgc2VsZWN0ZWQ9dGhpcy5jb21tZW50c1tjb21tZW50SW5kZXhdLmxpa2VTZWxlY3RlZDsKICAgICAgdmFyIF9saWtlOwogICAgICBpZiAoc2VsZWN0ZWQpIHsKICAgICAgICBfbGlrZT10aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZS0xOwogICAgICB9ZWxzZXsKICAgICAgICBfbGlrZT10aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZSsxOwogICAgICB9CiAgICAgIHZhciBpdGVtPXsKICAgICAgICBfaWQ6aWQsCiAgICAgICAgbGlrZTpfbGlrZQogICAgICB9CiAgICAgIHRoaXMuJGh0dHAucG9zdCgnc2VydmVyL2NvbW1lbnRzL3VwZGF0ZUxpa2UnLGl0ZW0pLnRoZW4oCiAgICAgICAgZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAvLyDlpITnkIbmiJDlip/nmoTnu5PmnpwKICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZT1fbGlrZTsKICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZVNlbGVjdGVkPSFzZWxlY3RlZDsKICAgICAgICAgICAgICBpZiAocm91dGU9PT11bmRlZmluZWQpIHsKICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudHNbY29tbWVudEluZGV4XS51bmxpa2VTZWxlY3RlZD1mYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgYWxlcnQocmVzLmRhdGEuZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAvLyDlpITnkIblpLHotKXnmoTnu5PmnpwKICAgICAgICBhbGVydChyZXMuZGF0YSk7CiAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["dialogWin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAsBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dialogWin.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <el-dialog id='dialogWin' title=\"查看对话\" top=\"10%\" :before-close=\"dialogWinClose\" :visible.sync=\"dialogWinVisible\" @open='loadComments'>\n    <div class=\"commentItems\">\n      <div v-for=\"(comment,commentIndex) in comments\">\n        <div class=\"AuthorInfo\">\n          <img :src=\"comment.userImage\" style=\"width24px;height:24px;\">\n          <span class=\"name\">{{comment.userName}}\n            <span v-show='comment.RootID'>回复</span>\n            {{comment.PName}}\n          </span>\n          <span class=\"CommentTime\">{{comment.createAt}}</span>\n        </div>\n        <p>{{comment.content}}</p>\n        <div class=\"buttons\">\n          <el-button type=\"info2\" icon=\"star-on\" @click=\"likeComment(commentIndex,comment._id)\" :class=\"{selected:comment.likeSelected}\">{{comment.like?comment.like:\"赞\"}}</el-button>\n           <el-button type=\"info2\" class=\"hoverBtn\" icon=\"star-off\" @click=\"dislikeComment(commentIndex,comment._id)\" :class=\"[{selected:comment.unlikeSelected}]\">{{comment.unlikeSelected?\"取消踩\":\"踩\"}}</el-button>\n        </div>\n      </div>\n    </div>\n  </el-dialog>\n</template>\n<script>\n  export default{\n    name:\"\",\n    data(){\n      return{\n        comments:[]\n      }\n    },\n    props:{\n      dialogWinVisible: {\n        type: Boolean\n      },\n      RootID:{\n        type:String\n      }\n    },\n    // mounted(){//渲染时加载评论\n    //   this.loadComments()\n    // },\n    methods:{\n      //对话窗口的关闭\n      dialogWinClose:function(){\n        this.$emit('closeDialogWin')\n      },\n      //加载会话内容\n      loadComments:function(){\n        this.$http.get('/server/comments/replay?r='+this.RootID).then(\n          function (res) {\n              // 处理成功的结果\n              if (res.data.success) {\n                this.comments=res.data.comments;\n                return;\n              }\n              else{\n                alert(\"展开评论失败，\"+res.data.error);\n              }\n            },function (res) {\n            // 处理失败的结果\n            alert(res.data);\n          });\n      },\n      //踩\n      dislikeComment:function(commentIndex,id){\n        if(this.comments[commentIndex].unlikeSelected){\n          this.comments[commentIndex].unlikeSelected=false;\n        }else{\n          if (this.comments[commentIndex].likeSelected) {\n            this.likeComment(commentIndex,id,'route');\n          }\n          this.comments[commentIndex].unlikeSelected=true;\n        }\n      },\n      //赞\n      likeComment:function(commentIndex,id,route){\n        let selected=this.comments[commentIndex].likeSelected;\n        var _like;\n        if (selected) {\n          _like=this.comments[commentIndex].like-1;\n        }else{\n          _like=this.comments[commentIndex].like+1;\n        }\n        var item={\n          _id:id,\n          like:_like\n        }\n        this.$http.post('server/comments/updateLike',item).then(\n          function (res) {\n              // 处理成功的结果\n              if (res.data.success) {\n                this.comments[commentIndex].like=_like;\n                this.comments[commentIndex].likeSelected=!selected;\n                if (route===undefined) {\n                  this.comments[commentIndex].unlikeSelected=false;\n                }\n                return;\n              }\n              else{\n                alert(res.data.error);\n              }\n            },function (res) {\n          // 处理失败的结果\n          alert(res.data);\n        })\n      }\n    }\n  }\n</script>\n<style lang='less'>\n  #dialogWin{\n    text-align: left;\n    .el-dialog__body{\n      height: 500px;\n      overflow-y: scroll;\n    }\n    .commentItems>div{\n      border-top: 1px solid #eee;\n      padding:10px;\n      .AuthorInfo{\n        margin: 10px 0px;\n        img{\n          cursor: pointer;\n        }\n        .name{\n          font-weight: 600;\n          line-height: 2;\n          vertical-align: text-bottom;\n          cursor: pointer;\n        }\n        .sign{\n          line-height: 2;\n          vertical-align: text-bottom;\n          font-size: 14px;\n        }\n      }\n      .hoverBtn{\n        display: none;\n      }\n      div:hover{\n        .hoverBtn{\n          display: inline-block;\n        }\n      }\n      .CommentTime {\n        vertical-align: super;\n        float: right;\n        color: #8590a6;\n      }\n      .el-button--info2{\n        color: #8590a6;\n        background-color: transparent;\n        border: none;\n        border-radius: 0;\n        padding: 8px 10px;\n      }\n      .buttons{\n        .selected{\n          color:#2d84cc;\n        }\n      }\n    }\n  }\n</style>"]}]}