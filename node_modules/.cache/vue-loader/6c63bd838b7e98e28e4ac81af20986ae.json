{"remainingRequest":"/Users/xutingting06/pat/personal-space/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/xutingting06/pat/personal-space/src/components/dialogWin.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/xutingting06/pat/personal-space/src/components/dialogWin.vue","mtime":1590318473666},{"path":"/Users/xutingting06/pat/personal-space/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/xutingting06/pat/personal-space/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmxldCByZXFVcmwgPSBsb2NhdGlvbi5vcmlnaW4ucmVwbGFjZShsb2NhdGlvbi5wb3J0LCAnMzAwMCcpOwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiIiwKICAgIGRhdGEoKSB7CiAgICAgICAgcmV0dXJuewogICAgICAgICAgICBjb21tZW50czpbXQogICAgICAgIH0KICAgIH0sCiAgICBwcm9wczp7CiAgICAgICAgZGlhbG9nV2luVmlzaWJsZTogewogICAgICAgICAgICB0eXBlOiBCb29sZWFuCiAgICAgICAgfSwKICAgICAgICByb290SUQ6IHsKICAgICAgICAgICAgdHlwZTpTdHJpbmcKICAgICAgICB9CiAgICB9LAogICAgbW91bnRlZCgpIHsKICAgICAgICAvLyDmuLLmn5Pml7bliqDovb3or4TorroKICAgICAgICB0aGlzLmxvYWRDb21tZW50cygpCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIC8v5a+56K+d56qX5Y+j55qE5YWz6ZetCiAgICAgICAgZGlhbG9nV2luQ2xvc2U6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnY2xvc2VEaWFsb2dXaW4nKQogICAgICAgIH0sCiAgICAgICAgLy/liqDovb3kvJror53lhoXlrrkKICAgICAgICBsb2FkQ29tbWVudHM6ZnVuY3Rpb24oKXsKICAgICAgICAgICAgbGV0ICR2bSA9IHRoaXM7CiAgICAgICAgICAgICR2bS4kYXhpb3MoewogICAgICAgICAgICAgICAgdXJsOiByZXFVcmwgKyAnL2NvbW1lbnRzL3JlcGxheScsCiAgICAgICAgICAgICAgICBtZXRob2Q6ICdnZXQnLAogICAgICAgICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgICAgICAgICAgcjogJHZtLnJvb3RJRAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHdpdGhDcmVkZW50aWFsczogdHJ1ZQogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIC8vIOWkhOeQhuaIkOWKn+eahOe7k+aenAogICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICAkdm0uY29tbWVudHM9cmVzLmRhdGEuY29tbWVudHM7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBhbGVydCgi5bGV5byA6K+E6K665aSx6LSl77yMIityZXMuZGF0YS5lcnJvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgICAgLy8g5aSE55CG5aSx6LSl55qE57uT5p6cCiAgICAgICAgICAgICAgICBhbGVydChyZXMuZGF0YSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgLy/ouKkKICAgICAgICBkaXNsaWtlQ29tbWVudDpmdW5jdGlvbihjb21tZW50SW5kZXgsaWQpewogICAgICAgICAgICBpZih0aGlzLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0udW5saWtlU2VsZWN0ZWQpewogICAgICAgICAgICAgICAgdGhpcy5jb21tZW50c1tjb21tZW50SW5kZXhdLnVubGlrZVNlbGVjdGVkPWZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgaWYgKHRoaXMuY29tbWVudHNbY29tbWVudEluZGV4XS5saWtlU2VsZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxpa2VDb21tZW50KGNvbW1lbnRJbmRleCxpZCwncm91dGUnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuY29tbWVudHNbY29tbWVudEluZGV4XS51bmxpa2VTZWxlY3RlZD10cnVlOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICAvL+i1ngogICAgICAgIGxpa2VDb21tZW50OmZ1bmN0aW9uKGNvbW1lbnRJbmRleCxpZCxyb3V0ZSl7CiAgICAgICAgICAgIGxldCAkdm0gPSB0aGlzOwogICAgICAgICAgICBsZXQgc2VsZWN0ZWQ9JHZtLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZVNlbGVjdGVkOwogICAgICAgICAgICB2YXIgX2xpa2U7CiAgICAgICAgICAgIGlmIChzZWxlY3RlZCkgewogICAgICAgICAgICAgICAgX2xpa2U9JHZtLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZS0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgICBfbGlrZT0kdm0uY29tbWVudHNbY29tbWVudEluZGV4XS5saWtlKzE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdmFyIGl0ZW09ewogICAgICAgICAgICAgICAgX2lkOmlkLAogICAgICAgICAgICAgICAgbGlrZTpfbGlrZQogICAgICAgICAgICB9CiAgICAgICAgICAgICR2bS4kYXhpb3MoewogICAgICAgICAgICAgICAgdXJsOiByZXFVcmwgKyAnL2NvbW1lbnRzL3VwZGF0ZUxpa2UnLAogICAgICAgICAgICAgICAgbWV0aG9kOiAncG9zdCcsCiAgICAgICAgICAgICAgICBwYXJhbXM6IGl0ZW0sCiAgICAgICAgICAgICAgICB3aXRoQ3JlZGVudGlhbHM6IHRydWUKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgICAvLyDlpITnkIbmiJDlip/nmoTnu5PmnpwKICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgJHZtLmNvbW1lbnRzW2NvbW1lbnRJbmRleF0ubGlrZT1fbGlrZTsKICAgICAgICAgICAgICAgICAgICAkdm0uY29tbWVudHNbY29tbWVudEluZGV4XS5saWtlU2VsZWN0ZWQ9IXNlbGVjdGVkOwogICAgICAgICAgICAgICAgICAgIGlmIChyb3V0ZT09PXVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgICAgICAgICAkdm0uY29tbWVudHNbY29tbWVudEluZGV4XS51bmxpa2VTZWxlY3RlZD1mYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXMuZGF0YS5lcnJvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICAgIC8vIOWkhOeQhuWksei0peeahOe7k+aenAogICAgICAgICAgICAgICAgYWxlcnQocmVzLmRhdGEpOwogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0KfQo="},{"version":3,"sources":["dialogWin.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"dialogWin.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <el-dialog id='dialogWin' title=\"查看对话\" top=\"10%\" :before-close=\"dialogWinClose\" :visible.sync=\"dialogWinVisible\">\n        <div class=\"commentItems\">\n            <div v-for=\"(comment,commentIndex) in comments\">\n                <div class=\"AuthorInfo\">\n                    <img :src=\"comment.userImage\" style=\"width24px;height:24px;\">\n                    <span class=\"name\">{{comment.userName}}\n                    <span v-show='comment.rootID'>回复</span>\n                        {{comment.PName}}\n                    </span>\n                    <span class=\"CommentTime\">\n                        {{comment.createAt}}\n                    </span>\n                </div>\n                <p>{{comment.content}}</p>\n                <div class=\"buttons\">\n                    <el-button type=\"info2\" icon=\"star-on\" @click=\"likeComment(commentIndex,comment._id)\" :class=\"{selected:comment.likeSelected}\">\n                        {{comment.like? \"赞\"+comment.like : \"赞\"}}\n                    </el-button>\n                    <el-button type=\"info2\" class=\"hoverBtn\" icon=\"star-off\" @click=\"dislikeComment(commentIndex,comment._id)\" :class=\"[{selected:comment.unlikeSelected}]\">\n                        {{comment.unlikeSelected ? \"取消踩\" : \"踩\"}}\n                    </el-button>\n                </div>\n            </div>\n        </div>\n    </el-dialog>\n</template>\n<script>\n    let reqUrl = location.origin.replace(location.port, '3000');\n    export default {\n        name: \"\",\n        data() {\n            return{\n                comments:[]\n            }\n        },\n        props:{\n            dialogWinVisible: {\n                type: Boolean\n            },\n            rootID: {\n                type:String\n            }\n        },\n        mounted() {\n            // 渲染时加载评论\n            this.loadComments()\n        },\n        methods: {\n            //对话窗口的关闭\n            dialogWinClose:function(){\n                this.$emit('closeDialogWin')\n            },\n            //加载会话内容\n            loadComments:function(){\n                let $vm = this;\n                $vm.$axios({\n                    url: reqUrl + '/comments/replay',\n                    method: 'get',\n                    params: {\n                        r: $vm.rootID\n                    },\n                    withCredentials: true\n                }).then(function (res) {\n                    // 处理成功的结果\n                    if (res.data.success) {\n                        $vm.comments=res.data.comments;\n                        return;\n                    }\n                    else{\n                        alert(\"展开评论失败，\"+res.data.error);\n                    }\n                },function (res) {\n                    // 处理失败的结果\n                    alert(res.data);\n                });\n            },\n            //踩\n            dislikeComment:function(commentIndex,id){\n                if(this.comments[commentIndex].unlikeSelected){\n                    this.comments[commentIndex].unlikeSelected=false;\n                }\n                else {\n                    if (this.comments[commentIndex].likeSelected) {\n                        this.likeComment(commentIndex,id,'route');\n                    }\n                    this.comments[commentIndex].unlikeSelected=true;\n                }\n            },\n            //赞\n            likeComment:function(commentIndex,id,route){\n                let $vm = this;\n                let selected=$vm.comments[commentIndex].likeSelected;\n                var _like;\n                if (selected) {\n                    _like=$vm.comments[commentIndex].like-1;\n                }\n                else{\n                    _like=$vm.comments[commentIndex].like+1;\n                }\n                var item={\n                    _id:id,\n                    like:_like\n                }\n                $vm.$axios({\n                    url: reqUrl + '/comments/updateLike',\n                    method: 'post',\n                    params: item,\n                    withCredentials: true\n                }).then(function (res) {\n                    // 处理成功的结果\n                    if (res.data.success) {\n                        $vm.comments[commentIndex].like=_like;\n                        $vm.comments[commentIndex].likeSelected=!selected;\n                        if (route===undefined) {\n                            $vm.comments[commentIndex].unlikeSelected=false;\n                        }\n                        return;\n                    }\n                    else{\n                        alert(res.data.error);\n                    }\n                }, function (res) {\n                    // 处理失败的结果\n                    alert(res.data);\n                })\n            }\n        }\n    }\n</script>\n<style lang='less'>\n#dialogWin{\n    text-align: left;\n    .el-dialog__body{\n        height: 500px;\n        overflow-y: scroll;\n    }\n    .commentItems>div{\n        border-top: 1px solid #eee;\n        padding:10px;\n        .AuthorInfo{\n            margin: 10px 0px;\n            img{\n                cursor: pointer;\n            }\n            .name{\n                font-weight: 600;\n                line-height: 2;\n                vertical-align: text-bottom;\n                cursor: pointer;\n                margin-left: 5px;\n            }\n            .sign{\n                line-height: 2;\n                vertical-align: text-bottom;\n                font-size: 14px;\n            }\n        }\n        .hoverBtn{\n            display: none;\n        }\n        div:hover {\n            .hoverBtn {\n                display: inline-block;\n            }\n        }\n        .CommentTime {\n            vertical-align: super;\n            float: right;\n            color: #8590a6;\n        }\n        .el-button--info2{\n            color: #8590a6;\n            background-color: transparent;\n            border: none;\n            border-radius: 0;\n            padding: 8px 10px;\n        }\n        .buttons{\n            .selected{\n                color:#2d84cc;\n            }\n        }\n    }\n}\n</style>"]}]}